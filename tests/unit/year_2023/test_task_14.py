import pytest

from aoc.year_2023.task_14 import Direction, Platform

INPUT = """O....#....
O.OO#....#
.....##...
OO.#O....O
.O.....O#.
O.#..O.#.#
..O..#O..O
.......O..
#....###..
#OO..#....""".split()

OUTPUT_NORTH = """
OOOO.#.O..
OO..#....#
OO..O##..O
O..#.OO...
........#.
..#....#.#
..O..#.O.O
..O.......
#....###..
#....#....
"""


def test_north():
    p = Platform(INPUT)
    p.tilt(Direction.NORTH)

    assert OUTPUT_NORTH == str(p)
    assert p.get_weight(Direction.NORTH) == 136


OUTPUT_1 = """
.....#....
....#...O#
...OO##...
.OO#......
.....OOO#.
.O#...O#.#
....O#....
......OOOO
#...O###..
#..OO#....
"""

OUTPUT_2 = """
.....#....
....#...O#
.....##...
..O#......
.....OOO#.
.O#...O#.#
....O#...O
.......OOO
#..OO###..
#.OOO#...O
"""

OUTPUT_3 = """
.....#....
....#...O#
.....##...
..O#......
.....OOO#.
.O#...O#.#
....O#...O
.......OOO
#...O###.O
#.OOO#...O
"""


@pytest.mark.parametrize(
    "num_cycle, expected_output", [(1, OUTPUT_1), (2, OUTPUT_2), (3, OUTPUT_3)]
)
def test_1_cycle(num_cycle, expected_output):
    p = Platform(INPUT)
    for i in range(num_cycle):
        for d in [Direction.NORTH, Direction.WEST, Direction.SOUTH, Direction.EAST]:
            p.tilt(d)
    assert expected_output == str(p)


100141
100187
100307
100399
100480
100525
100582
100571
100551
100609
100673
100765
100824
100869
100905
100882
100852
100850
100826
100828
100820
100808
100813
100821
100844
100797
100807
100826
100834
100879
100940
101002
101065
101083
101073
101061
101017
100982
100946
100900
100865
100826
100791
100763
100724
100663
100599
100513
100414
100333
100228
100154
100098
100030
99998
99939
99901
99837
99780
99690
99644
99595
99545
99503
99455
99438
99427
99417
99375
99364
99354
99329
99325
99316
99316
99290
99265
99211
99200
99179
99168
99172
99166
99165
99137
99137
99111
99099
99118
99131
99162
99150
99139
99142
99146
99095
99112
99133
99147
99146
99124
99144
99151
99130
99108
99127
99149
99131
99120
99129
99153
99135
99143
99123
99143
99133
99105
99125
99138
99137
99148
99158
99139
99127
99107
99110
99134
99122
99150
99163
99174
99123
99101
99112
99119
99118
99135
99165
99179
99158
99097
99106
99121
99103
99131
99150
99181
99163
99132
99102
99115
99105
99116
99146
99166
99165
99137
99137
99111
99099
99118
99131
99162
99150
99139
99142
99146
99095
99112
99133
99147
99146
99124
99144
99151
99130
99108
99127
99149
99131
99120
99129
99153
99135
99143
99123
99143
99133
99105
99125
99138
99137
99148
99158
99139
99127
99107
99110
99134
99122
99150
99163
99174
99123
99101
99112
99119
99118
99135
99165
99179
99158
99097
99106
99121
99103
99131
99150
99181
99163
99132
99102
99115
99105
99116
99146
99166
99165
99137
99137
99111
99099
99118
99131
99162
99150
99139
99142
99146
99095
99112
99133
99147
99146
99124
99144
99151
99130
99108
99127
99149
99131
99120
99129
99153
99135
99143
99123
99143
99133
99105
99125
99138
99137
99148
99158
99139
99127
99107
99110
99134
99122
99150
99163
99174
99123
99101
99112
99119
99118
99135
99165
99179
99158
99097
99106
99121
99103
99131
99150
99181
99163
99132
99102
99115
99105
99116
99146
99166
99165
99137
99137
99111
99099
99118
99131
99162
